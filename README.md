# sbbol-over-net


# Что это
Пробрасыватель USB-версии (флэшка) сббол по локальной сети.
На самом деле это не флэшка, а композитное устройство на микроконтроллере,
которое отдает операционной системе интерфейсы смарт-карты и блочного устройства (флэш-диск).
На флэш-диске лежит win32 приложение (назовем его красивым и подходящим во всех смыслах словом гейт), которое транслирует запросы пользователя через встроенный http-сервер и самостоятельно определяет запросы к смарт-карте и обслуживает их. Поскольку криворукие разработчики не удосужились собрать свой примитивный транслятор для других архитектур, запустить это изделие можно только сами понимаете на чем. Еще контроллер при подаче питания генерирует новый ключ доступа к вэб-интерфейсу и кладет его на флэш-диск.


# Как это упрощает жизнь
-- Не нужно ломать USB-ключ и порт в компьютере бухгалтера.
-- Доступ с любого рабочего места с любой ОС из любого современного браузера.
-- USB-ключ заперт в серверной, а работать можно хоть откуда (если есть свой VPN).
-- Существенное ускорение работы благодаря кэшированию и использованию актуальных версий js-библиотек.
-- Вероятность зависания гейта нулевая из-за правильной работы в один поток и многократному уменьшению трафика через него.
-- Возможность организации доступа по схеме 2 ключа (пин-код только у администратора, пароль только у бухгалтера).


# Какие возникнут проблемы
-- Контроллер в ключе может зависнуть, а перезапустить его можно только снятием питания, перезагрузка сервера не поможет.
   Для решения нужно уметь удаленно включать сервер, или управлять питанием USB устройста либо через USB-контроллер/хаб,
   либо внешним устройством. Можно еще отправить специально обученного человека, чтобы вынуть-вставить ключ.
-- Гейт зависнет, если засыпАть его запросами, пока он не может установить восходящее соединение (при проблемах со связью).
-- Гейт допускает только одну открытую сессию (макс. таймаут 60 мин).
-- Гейт неправильно определяет открытую сессию. Правильно определяется открытая сессия только первый раз.
   Даже если вы откажетесь разрывать сессию, при повторном запросе на новую сессию предупреждения об уже открытой сессии вы не увидите.
-- Некоторые операции по обслуживанию сертификатов могут работать только локально (в штатном режиме).
-- Иногда возникает тайм-аут. Его природу установить не удалось, скорее всего ошибочно удаляется файл сессии на серверной стороне.
-- Внимание! Все критические данные (пин-коды, сеансовые ключи, идентификаторы сессий, ключ доступа к вэб-интерфейсу) передаются
   в открытом виде, при использовании в недоверенной локальной сети или через интернет включайте https-режим nginx'a.


# Что нужно для работы
Вин XP, возможно заработает на 7-10 (не проверял),
можно в виртуальной машине (vbox 5.x работает)
+
nginx 1.9.4 и выше
nnCron [+rbl.spf прилагается]
imdisk
(гугл в помощь)

Распаковать архив из b64 файла в html/ nginx'a и дать последнему конфиг.
Подключить список задач и плагин rbl к nnCron.
Установить менеджер рам-дисков imdisk.
Указать рабочие пути и адреса в конфиге и табе.
Перезагрузиться.

Должно заработать ;)

P.S. Извините, но понять как github форматирует README.md я не могу, так что читайте в редакторе.
